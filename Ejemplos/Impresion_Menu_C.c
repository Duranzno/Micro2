//#include "barras.h"
//#include "sprites.h"


const code char charmander_1[1024] = {
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 192,  32,  16,   0,   8,   8,   8,   8,   0,  16,  16, 160, 192,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 128, 128,  64,  64,  64,  64,  64, 128, 128,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 223,  62,  56,  16,   0,   0,   0,  16,  28, 174, 127, 252, 252, 255, 255, 240, 128,   0,   0,   0,   0,   0,   0,   0,   0,   8, 112, 224, 192,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 120, 134,   1,   0,   0,   0,   0,   0,  28,  36, 124, 120,  49,   6,  24,  96, 128,   0, 240,  56, 212,   8,  20,  24, 240,   0,   0, 128,   0, 192, 176,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   2,   4,   8,   8, 136, 200,  60,  26,  29, 142,  79,  55,  27,   3,   7, 143, 254, 248, 112,  64, 128,   0,   0,   0,   0,   0, 131, 255, 255, 252, 240,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112, 152,   8, 104,  73,  15,  48,  64, 192, 128, 128,  80,  64,  32, 152, 151,  72,  48,  12,   1,   6,   1,   0,   0, 192, 112,  14,   1,   0,   1,  10,  21,  11, 151, 111, 158,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  28,  50,  41,  33,  16,  31,  96, 128,  14,  25,  20,  24,   8,   4,  62, 135,   1,   0,   0,   0,   0, 131, 252, 252, 254, 127,  63,  31,  15,   3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   2,   2,   2,   7, 135, 247,  15,   1,   1,   1,   0,   0,   0,   0,   0, 128,  64,   0,   0,   1,   3,  28, 112, 144,  16, 136, 136, 196, 226, 249,  62,  15,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 128,  64,  32,  32,  17,  10, 140, 156, 248, 248, 232,   8,   5,   6, 124, 132,   6, 143,  29,  56, 240, 224, 192, 128,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 128,  78,  81,  32,  32,  67, 204, 248, 240, 240,  96,  32,  32,  62,  57, 112, 224, 224,  64,  64,  64,  96,  95, 135,   7,   3,   3,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   2,   3,   2,   2,   3,   2,   3,   1,   1,   0,   0,   0,   0,   0,   1,   2,   2,   3,   2,   3,   3,   3,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   1,   1,   1,   1,   1,   1,   0,   0,   0,   0,   0,   0,   0,   1,   2,   2,   2,   2,   2,   2,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0
};

//
//    const code char kirby_1[78] = {
//0,   0, 128,  64,  96,  32,  56,  12,   6,   2,   3,   1,  41, 241,   1,  43, 242,   6,  12,  48,  32,  96, 192,   0,   0,   0,
//0,   0,   3,   4,   8,   8,  24, 240, 224, 192, 192, 192, 192, 224, 152, 132, 194, 226, 226, 124,  60,   4,   3,   0,   0,   0,
//0,   0,   0,   0,   0,   0,   0,   1,   3,   7,   7,   7,   7,   3,   1,   1,   1,   1,   0,   0,   0,   0,   0,   0,   0,   0
//};
//                    // ------------------------------------------------------
//// GLCD Picture name: 2.bmp
//// GLCD Model: KS0108 128x64
//// ------------------------------------------------------
//
//const code char kirby_2[69] = {
//  0,   0,   0, 128, 224,  56,  12,   4,   6,   2,   2, 210, 226,   2,  22, 228,  12,  56, 224, 128,   0,   0,   0,
//  0,  30,  63,  33, 224, 224, 192, 128, 128,   0,   0,   0, 129,  64,  68,  65, 192, 224, 161,  49,  30,   0,   0,
//  0,   0,   0,   0,   3,   7,   7,   6,   7,   3,   3,   7,   6,   6,   6,   6,   6,   7,   3,   0,   0,   0,   0
//};
//
//
//const code char kirby_3[69] = {
//0,   0, 192,  96,  48,  16,  24,   8,   8,   8,   8, 168, 200,   8, 168, 208,  16,  96, 192,   0,   0,   0,   0,
//0,  63,  97, 208, 160,  64,  64, 192,  96,  64,  64,  64,  67, 128, 136, 131, 128, 192, 113,  63,   0,   0,   0,
//0,   0,   0,   0,   1,   1,   3,   7,   6,   6,   6,   6,   6,   6,   7,   3,   1,   0,   0,   0,   0,   0,   0
//};
//// ------------------------------------------------------
//// GLCD Picture name: 4.bmp
//// GLCD Model: KS0108 128x64
//// ------------------------------------------------------
//
//const code char kirby_4[69] = {
//  0,   0,   0, 240,  60,  14,   6,   3,   1,   1,   1,   1,   1, 129,  11,  54, 230,  28, 240,   0,   0,   0,   0,
//  0, 240, 184,  15,  56,  96, 192, 192, 192, 128, 128, 132, 128, 193, 192, 192, 224, 242, 255, 226, 126,  60,   0,
//  0,   1,   3,   7,   6,   7,   7,   7,   3,   0,   0,   0,   0,   0,   1,   1,   1,   1,   0,   0,   0,   0,   0
//};
//
//
//const code char kirby_5[69] = {
//0,   0, 192, 112,  24,  12,   4,   6,   2,   2,   2,   2,   2,  22, 230,  20, 236, 120, 224,   0,   0,   0,   0,
//0, 252, 143,   8,  48,  96, 192, 144,  16,  16,   0,   4,   0, 128, 129, 132,  65,  48, 127,  64, 128,   0,   0,
//0,   3,   7,   6,   6,   7,   3,   1,   1,   1,   1,   1,   3,   7,   7,   7,   7,   6,   6,   7,   3,   0,   0
//};
// PS2 pinout definition
//sbit PS2_Data at RF4_bit;
//sbit PS2_Clock at RF5_bit;
//sbit PS2_Data_Direction at TRISF4_bit;
//sbit PS2_Clock_Direction at TRISF5_bit;
// End of PS2 pinout definition
// Glcd module connections
sbit GLCD_D7 at RE1_bit;
sbit GLCD_D6 at RE0_bit;
sbit GLCD_D5 at RF1_bit;
sbit GLCD_D4 at RF0_bit;
sbit GLCD_D3 at RD7_bit;
sbit GLCD_D2 at RD6_bit;
sbit GLCD_D1 at RD5_bit;
sbit GLCD_D0 at RD4_bit;
sbit GLCD_D7_Direction at TRISE1_bit;
sbit GLCD_D6_Direction at TRISE0_bit;
sbit GLCD_D5_Direction at TRISF1_bit;
sbit GLCD_D4_Direction at TRISF0_bit;
sbit GLCD_D3_Direction at TRISD7_bit;
sbit GLCD_D2_Direction at TRISD6_bit;
sbit GLCD_D1_Direction at TRISD5_bit;
sbit GLCD_D0_Direction at TRISD4_bit;
sbit GLCD_CS1 at LATE3_bit;
sbit GLCD_CS2 at LATE2_bit;
sbit GLCD_RS at LATD1_bit;
sbit GLCD_RW at LATD2_bit;
sbit GLCD_EN at LATD3_bit;
sbit GLCD_RST at LATE4_bit;
sbit GLCD_CS1_Direction at TRISE3_bit;
sbit GLCD_CS2_Direction at TRISE2_bit;
sbit GLCD_RS_Direction at TRISD1_bit;
sbit GLCD_RW_Direction at TRISD2_bit;
sbit GLCD_EN_Direction at TRISD3_bit;
sbit GLCD_RST_Direction at TRISE4_bit;
//   void INT0() org 0x14{
// int a=1;}
//void INT1() org 0x3C{
//int a=1;}
//void INT2() org 0x4E{int a=1;}
//void INT3() org 0x7E{int a=1;}
//void INT4() org 0x80{int a=1;}

//void config_INT(){
//  SRbits.IPL =0;// iNTERRUPCION DE CPU ES DE NIVEL 0
//  INTCON1bits.NSTDIS =0;// INTERRUPCION ANIDADAS ACTIVADAS
//  INTCON2bits.GIE=1; //interrupciones habilitadas
//  CORCONbits.IPL3 = 0; // El nivel del cpu es de nivel 0, las interrupciones por perifericos habilitadas
////------------------------- habilitacion de interrupcion
//  IEC0bits.INT0IE=1; //HABILITA INTERRUPCION POR INT0
//  IEC1bits.INT1IE=1; //HABILITA
//  IEC1bits.INT2IE=1;
//  IEC3bits.INT3IE=1;
//  IEC3bits.INT4IE=1;
//// Banderas de Interrupcion post Reset (Limpieza)
//  IFS0bits.INT0IF=0; //interrupcion de INT0 ACTIVADA
//  IFS1bits.INT2IF =0; // interrupcion de INT1 ACTIVADA
//  IFS1bits.INT2IF =0 ; // INTERRIPCION DE INT2 ACTVADA
//  IFS3bits.INT3IF =0; //INTERRUPCION DE INT3 ACTIVADA
//  IFS3bits.INT4IF =0; // INTERRUPCION DE INT4 ACTIVADA
////Prioridad de Interrupciones
//  IPC0bits.INT0IP= 5;
//  IPC5BITS.INT1IP= 4;
//  IPC7bits.INT2IP =3;
//  IPC13bits.INT3IP=2;
//  IPC13bits.INT4IP=1;
////--------------------interrupcion flanco positivo
//  INTCON2bits.INT0EP=0;
//  INTCON2bits.INT1EP=0;
//  INTCON2bits.INT2EP=0;
//  INTCON2bits.INT3EP=0;
//  INTCON2bits.INT4EP =0;
//}
// const int BTN_PPS_LOCATIONS[5]={-1,37,36,35,34};//5 posiciones para las 4 Ubicaciones de los botones de Interrupciion del ejercicio 1
// el 0 nunca se usa porque INT0 esta fijo en el pin 46 RP64. RB2-5
//const int DIP_PPS_LOCATIONS[5]={32,33,38,39,40};//5 posiciones para 5 Dipswitches RPI32,33,38,39,40 Y RB0,1,6,7,8
//const int KEYBOARD_PPS_LOCATIONS[2]={100,101};//RF4,RF5
//const int LED_PPS_LOCATIONS[3]={85,87,118};//3 posiciones para 3 LEDS de salida

// void config_IO(){
// //TRISx,PORTX,LATx,ODCx
//   ANSELB=0;
//   ANSELC=0; ANSELD=0; ANSELE=0;                  //ANALOGICO SON B Y F
//   //------------------------------------------------------
//   //Asignacion Pines Entrada
//   //INT0 No tiene PPS y es constante, a los demas se les tiene que colocar
//   //el numero del RPINx en su registro correspondiente.
//    //Necesito otras entradas para el 5 dipswitches, y 4 de usb/ps/2
//   RPINR0bits.INT1R = BTN_PPS_LOCATIONS[1];//El Periferico INT1 esta en el pin 47
//   RPINR1bits.INT2R = BTN_PPS_LOCATIONS[2];
//   RPINR1bits.INT3R=  BTN_PPS_LOCATIONS[3];
//   RPINR2bits.INT4R=  BTN_PPS_LOCATIONS[4];
//   //Necesito 3 salidas extras de GPIO
// }
// void config_CN(){
// //CNENx, CNPUx,CNIEx
//      TRISB = 0;
//      CNENBbits.CNIEB0=1;
//      CNENBbits.CNIEB1=1;
//      CNENBbits.CNIEB6=1;
//      CNENBbits.CNIEB7=1;
//      CNENBbits.CNIEB8=1;
//      //CNPU
//      CNPUBbits.CNPUB0=1;
//      CNPUBbits.CNPUB1=1;
//      CNPUBbits.CNPUB6=1;
//      CNPUBbits.CNPUB7=1;
//      CNPUBbits.CNPUB8=1;
//      //RB1-rb5, rpi33-37
//      IFS1bits.CNIF=0;
//      IEC1bits.CNIE=1;//Resset Interrupcion
// }

//unsigned short keydata = 0;
//unsigned short special = 0;
//unsigned short down = 0;
//    int op=0;
void casoC(){
 Glcd_Write_TEXT("Ultimo Reset",60,0,1);
 do{
   if (RCONbits.WDTO==1){
     Glcd_Write_TEXT("WDT",0,1,BLACK);
     delay_ms(500);
     RCONbits.WDTO=0;
   }else if(RCONbits.EXTR==1){
     Glcd_Write_TEXT("MCLR",0,2,1);     
     delay_ms(500);
     RCONbits.EXTR=0;
   }else if (RCONbits.POR==1){
     Glcd_Write_TEXT("POR",0,3,1);  
     delay_ms(500);
     RCONbits.POR=0;
   }
 while(Ps2_Key_Read(&keydata, &special, &down));
 }while(op!=34);
 op='c';
}
void main(){
//  config_INT();
//  config_IO();
//  config_CN();//para los dipswitches 
  Glcd_Init();
  Glcd_Set_Font(font5x7 , 5, 7, 32);
  Glcd_Fill(0);

while(1){
 Glcd_Image(charmander_1);
 delay_ms(500);}
} 
PS2_Config();
      Glcd_Write_TEXT("Laboratorio 1",31,0,1);
         delay_ms(3000);
while(1){       // Invert PORTB value
 Glcd_Write_TEXT("Laboratorio 1",31,0,1);
 Glcd_Image(charmander_1);         
 delay_ms(3000);
 Glcd_Fill(0);
 Glcd_Write_TEXT("Presione 'A' para Caso 1",0,1,1);
 Glcd_Write_TEXT("Presione 'B' para Caso 2",0,2,1);
 Glcd_Write_TEXT("Presione 'C' para Caso 3",0,3,1);
 Glcd_Write_TEXT("Presione 'D' para WDT   ",0,4,1);
     delay_ms(3000);
 
  while(op!=34){
   if(Ps2_Key_Read(&keydata, &special, &down)){
   Glcd_Fill(0);
   switch(op){
     case 'a':
     Glcd_Write_TEXT("Caso A",60,0,1);
     delay_ms(1000);
     op=keydata;
     break;

     case 'b':
     Glcd_Write_TEXT("Caso B ",60,0,1);
     delay_ms(1000);
     op=keydata;
     break;

     case 'c':
     Glcd_Write_TEXT("Caso C ",60,0,1);
     delay_ms(1000);
     casoC();
     op=keydata;
     break;

     case 'd':
     Glcd_Write_TEXT("Caso D ",60,0,1);
     delay_ms(1000);
     op=keydata;
     break;

     case 34:
     Glcd_Write_TEXT("Menu Principal ",60,0,1);
     delay_ms(1000);
     op=keydata;
     //continue
     break;
     default:
     Glcd_Write_TEXT("Erroneo ",60,0,1);
     delay_ms(1000);
     break;
     }
   }
 }
}
}